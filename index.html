<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="./assets/index.css">
    <link rel="icon" type="image/x-icon" href="https://play-lh.googleusercontent.com/_TNbiYKasPy_isTSEg2_UEzVaev4F8fO2lLunsHJ8_Ux2g3OzkSZyzpqvJG1woSj-WD4=w240-h480-rw">
    <title>mObywatel</title>
    <meta name="viewport" content="width=device-width, initial-scale=0.8, user-scalable=no">
</head>
<body>
    <div class="theme-toggle">
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
    <div class="theme-panel">
        <h3>Wybierz motyw</h3>
        <div class="theme-options">
            <div class="theme-option" data-theme="default">
                <div class="color-preview"></div>
                <span>Domyślny</span>
            </div>
            <div class="theme-option" data-theme="dark">
                <div class="color-preview"></div>
                <span>Ciemny</span>
            </div>
            <div class="theme-option" data-theme="neon">
                <div class="color-preview"></div>
                <span>Neon</span>
            </div>
            <div class="theme-option" data-theme="gradient">
                <div class="color-preview"></div>
                <span>Gradient</span>
            </div>
        </div>
    </div>
    <img src="https://play-lh.googleusercontent.com/_TNbiYKasPy_isTSEg2_UEzVaev4F8fO2lLunsHJ8_Ux2g3OzkSZyzpqvJG1woSj-WD4" class="logo">

    <div class="header-container">
        <p class="logo_text">mObywatel</p>
    </div>
    <div class="button-container">
        <a class="generate-btn">Generuj</a>
        <a class="clear-btn">Wyczyść</a>
    </div>

    <p class="warning">ta strona jest przeznaczona do robienia dowodów</p>

    <div class="input_holder">
        <input type="text" id="image" class="input" placeholder="">
        <span class="placeholder">Link do zdjęcia (ImgBB/Discord)</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <div class="image-preview-modal">
        <div class="image-preview-content">
            <button class="close-preview">×</button>
            <img class="preview-image" src="" alt="Podgląd">
        </div>
    </div>

    <div class="input_holder">
        <input type="text" id="name" class="input" placeholder="">
        <span class="placeholder">Imię (imiona)</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <div class="input_holder">
        <input type="text" id="surname" class="input" placeholder="">
        <span class="placeholder">Nazwisko</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <p class="top_info">Płeć</p>
    <div class="selector_box">
        <div class="selected_grid">
            <p class="selector_text selected_text">Mężczyzna</p>
            <img class="selected_arrow" src="https://i.imgur.com/RXsdBB6.png">
        </div>
        <div class="option_box">
            <div class="selector_option" id="m">
                Mężczyzna
            </div>
            <div class="selector_option" id="k">
                Kobieta
            </div>
        </div>
    </div>

    <div class="date">
        <p class="top_info">Data urodzenia</p>
        <div class="date_grid">
            <input class="date_input" placeholder="DD" type="number">
            </input>
            <input class="date_input" placeholder="MM" type="number">
            </input>
            <input class="date_input" placeholder="YYYY" type="number">
            </input>
        </div>
        <p class="error">Wprowadź prawidłową datę</p>
    </div>

    <div class="input_holder">
        <input type="text" id="nationality" class="input" placeholder="">
        <span class="placeholder">Obywatelstwo</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <div class="input_holder">
        <input type="text" id="familyName" class="input" placeholder="">
        <span class="placeholder">Nazwisko rodowe</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <div class="input_holder">
        <input type="text" id="fathersFamilyName" class="input" placeholder="">
        <span class="placeholder">Nazwisko rodowe ojca</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <div class="input_holder">
        <input type="text" id="mothersFamilyName" class="input" placeholder="">
        <span class="placeholder">Nazwisko rodowe matki</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <p class="subtext">Miejsce zamieszkania</p>

    <div class="input_holder">
        <input type="text" id="birthPlace" class="input" placeholder="">
        <span class="placeholder">Miejsce urodzenia</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <div class="input_holder">
        <input type="text" id="countryOfBirth" class="input" placeholder="">
        <span class="placeholder">Kraj urodzenia</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <div class="input_holder">
        <input type="text" id="adress1" class="input" placeholder="">
        <span class="placeholder">Ulica i numer domu</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <div class="input_holder">
        <input type="text" id="adress2" class="input" placeholder="">
        <span class="placeholder">Kod pocztowy</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <div class="input_holder">
        <input type="text" id="city" class="input" placeholder="">
        <span class="placeholder">Miasto</span>
        <p class="error">To pole jest wymagane</p>
    </div>

    <a class="go">wejdź</a>
    <div class="instagram" onclick="window.open('https://www.instagram.com/deyyv.v/')">
        <div class="inner_grid">
            <img class="instagram_image" src="https://i.imgur.com/JCi3FSA.png">
            <p class="instagram_text">Zaobserwój mnie na instagramie</p>
        </div>
    </div>

    <script>
        const themeToggle = document.querySelector('.theme-toggle');
        const themePanel = document.querySelector('.theme-panel');

        themeToggle.addEventListener('mouseenter', () => {
            themePanel.classList.add('active');
        });

        themePanel.addEventListener('mouseleave', () => {
            themePanel.classList.remove('active');
        });

        document.querySelectorAll('.theme-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
                
                const theme = option.getAttribute('data-theme');
                applyTheme(theme);
            });
        });

        function applyTheme(theme) {
            document.body.className = '';
            
            switch(theme) {
                case 'dark':
                    document.body.classList.add('dark-theme');
                    break;
                case 'neon':
                    document.body.classList.add('neon-theme');
                    break;
                case 'gradient':
                    document.body.classList.add('gradient-theme');
                    break;
                default:
                    document.body.className = '';
            }
            
            localStorage.setItem('selectedTheme', theme);
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('selectedTheme');
        if (savedTheme) {
            applyTheme(savedTheme);
            document.querySelector(`.theme-option[data-theme="${savedTheme}"]`).classList.add('active');
        }

        var selector = document.querySelector(".selector_box");
        selector.addEventListener('click', () => {
            if (selector.classList.contains("selector_open")) {
                selector.classList.remove("selector_open");
            } else {
                selector.classList.add("selector_open");
            }
        });

        document.querySelectorAll(".date_input").forEach((element) => {
            element.addEventListener('click', () => {
                document.querySelector(".date").classList.remove("error_shown");
            });
        });

        var sex = "m";

        document.querySelectorAll(".selector_option").forEach((option) => {
            option.addEventListener('click', () => {
                sex = option.id;
                document.querySelector(".selected_text").innerHTML = option.innerHTML;
                selector.classList.remove("selector_open");
            });
        });

        document.querySelectorAll(".input_holder").forEach((element) => {
            var input = element.querySelector(".input");
            input.addEventListener('click', () => {
                element.classList.remove("error_shown");
            });
        });

        const input = document.querySelector("#image");
        const previewModal = document.querySelector('.image-preview-modal');
        const previewImage = document.querySelector('.preview-image');
        const closePreview = document.querySelector('.close-preview');

        input.addEventListener('input', (event) => {
            const imageUrl = event.target.value;
            if (imageUrl.includes('ibb.co') || imageUrl.includes('imgbb.com') || imageUrl.includes('cdn.discordapp.com')) {
                localStorage.removeItem('userImage');
                input.setAttribute("selected", imageUrl);
                
                previewImage.src = imageUrl;
                previewModal.style.display = 'flex';
            }
        });

        closePreview.addEventListener('click', () => {
            previewModal.style.display = 'none';
        });

        previewModal.addEventListener('click', (e) => {
            if (e.target === previewModal) {
                previewModal.style.display = 'none';
            }
        });

        // Listy przykładowych danych
        const randomMaleSurnames = ["Kowalski", "Nowak", "Wiśniewski", "Wójcik", "Kowalczyk", "Kamiński", "Lewandowski", "Zieliński", "Szymański", "Woźniak"];
        const randomFemaleSurnames = ["Kowalska", "Nowak", "Wiśniewska", "Wójcik", "Kowalczyk", "Kamińska", "Lewandowska", "Zielińska", "Szymańska", "Woźniak"];
        const randomCities = ["Warszawa", "Kraków", "Łódź", "Wrocław", "Poznań", "Gdańsk", "Szczecin", "Bydgoszcz", "Lublin", "Katowice"];
        const randomStreets = ["Mickiewicza", "Słowackiego", "Kościuszki", "Piłsudskiego", "Sienkiewicza", "Reymonta", "Konopnickiej", "Prusa", "Wyspiańskiego"];

        function getRandomElement(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function generateRandomPostcode() {
            return String(Math.floor(Math.random() * 90 + 10)) + "-" + String(Math.floor(Math.random() * 900 + 100));
        }

        document.querySelector(".clear-btn").addEventListener('click', () => {
            document.querySelectorAll(".input_holder").forEach((element) => {
                var input = element.querySelector(".input");
                input.value = '';
            });
            
            document.querySelectorAll(".date_input").forEach((element) => {
                element.value = '';
            });
            
            localStorage.clear();
        });

        document.querySelector(".generate-btn").addEventListener('click', () => {
            document.querySelectorAll(".input_holder").forEach((element) => {
                var input = element.querySelector(".input");
                let randomValue = "";
                switch(input.id) {
                    case "surname":
                        randomValue = sex === "m" ? getRandomElement(randomMaleSurnames) : getRandomElement(randomFemaleSurnames);
                        break;
                    case "nationality":
                        randomValue = "POLSKA";
                        break;
                    case "familyName":
                        randomValue = sex === "m" ? getRandomElement(randomMaleSurnames) : getRandomElement(randomFemaleSurnames);
                        break;
                    case "fathersFamilyName":
                        randomValue = getRandomElement(randomMaleSurnames);
                        break;
                    case "mothersFamilyName":
                        randomValue = getRandomElement(randomFemaleSurnames);
                        break;
                    case "birthPlace":
                        randomValue = getRandomElement(randomCities);
                        break;
                    case "countryOfBirth":
                        randomValue = "POLSKA";
                        break;
                    case "adress1":
                        randomValue = "ul. " + getRandomElement(randomStreets) + " " + Math.floor(Math.random() * 100 + 1);
                        break;
                    case "adress2":
                        randomValue = generateRandomPostcode();
                        break;
                    case "city":
                        randomValue = getRandomElement(randomCities);
                        break;
                }
                if (randomValue && input.id !== "name") {
                    input.value = randomValue;
                }
            });
        });

        document.querySelector(".go").addEventListener('click', () => {
            var empty = [];
            var params = new URLSearchParams();
            params.set("sex", sex);
            
            const imageInput = document.querySelector("#image");
            if (!imageInput.value || !(imageInput.value.includes('ibb.co') || 
                                     imageInput.value.includes('imgbb.com') || 
                                     imageInput.value.includes('cdn.discordapp.com'))) {
                empty.push(imageInput.parentElement);
                imageInput.parentElement.classList.add("error_shown");
            } else {
                params.set("image", imageInput.value);
            }

            var birthday = "";
            var dateEmpty = false;
            document.querySelectorAll(".date_input").forEach((element) => {
                birthday = birthday + "." + element.value;
                if (isEmpty(element.value)) {
                    dateEmpty = true;
                }
            });

            birthday = birthday.substring(1);

            if (dateEmpty) {
                var dateElement = document.querySelector(".date");
                dateElement.classList.add("error_shown");
                empty.push(dateElement);
            } else {
                params.set("birthday", birthday);
            }

            document.querySelectorAll(".input_holder").forEach((element) => {
                var input = element.querySelector(".input");
                if (isEmpty(input.value)) {
                    empty.push(element);
                    element.classList.add("error_shown");
                } else {
                    params.set(input.id, input.value);
                }
            });

            if (empty.length != 0) {
                empty[0].scrollIntoView({ behavior: 'smooth' });
            } else {
                forwardToId(params);
            }
        });

        function isEmpty(value) {
            let pattern = /^\s*$/;
            return pattern.test(value);
        }

        function forwardToId(params) {
            const imageData = params.get('image');
            
            if (imageData) {
                localStorage.setItem('userImage', imageData);
                params.delete('image');
            }
            
            document.querySelectorAll(".input_holder").forEach((element) => {
                const input = element.querySelector(".input");
                if (input && input.value) {
                    localStorage.setItem(input.id, input.value);
                }
            });
            
            location.href = "./id.html?" + params.toString();
        }

        // Load saved form data when page loads
        window.addEventListener('load', () => {
            document.querySelectorAll(".input_holder").forEach((element) => {
                const input = element.querySelector(".input");
                if (input && localStorage.getItem(input.id)) {
                    input.value = localStorage.getItem(input.id);
                }
            });
        });
    </script>
</body>
</html>